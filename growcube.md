# Device identification

Unifi just recognises it as: ESP_3E0241 and manufacturer Espressif inc.

# Message structure

Each message has three sections separated by a # character and ends with a final #. These sections are:

- 1: **Message type** - "eleaXX" where XX is a number indicating the message type
- 2: **Content length** - Length in bytes of the message content (excluding any # characters)
- 3: **Message content** - ASCII content specific to the message type. Where the message content has structure fields are delimited by @ characters. Where fields then have further sub-fields these are deliminated by , characters.

For example:

```
elea48#1#0#
```

```
elea47#3#0@1#
```

```
elea22#83#0@2023@8@28@00,00,00,00,00,00,00,00,00,00,00,74,81,84,85,86,86,85,86,85,85,84,84,83#
```

# But...

The app also sends `ele506` and gets `ele550` as a response before sending some commands.

# Connection
If you connect, growcube sends a bunch of 0 bytes in between messages. I guess to keep the connection alive. 
If you do nothing it repeatedly sends the 30, 21, 21, 21, 21 sequence every 10s.

# Commands

# 48 - Get moisture history

`elea48#1#0#`

# Commands

## Current sensor values

### Request - none

### Response 30 - Sensor disconnected
`elea30#1#2`
 - content = the channel that is not connected

### Response 33 - ??
 - Only ever seen 0@0

### Response 21 - Sensor current status

`elea21#10#0@82@45@27#`

- Received every 10s
- #0 = channel
- @82@45@27 = Soil moisture - Humidity - Temperature

## Water Control

### Request: 47

`elea47#3#0@1#`

- #0 = channel
- @1 = requested state 1=>On, 0=>off

### Response: 26 - Watering-on command accepted

`elea26#1#0#`

- Received directly after issuing a watering-on command
- #0 = channel number

### Response: 27 - Watering-off command accepted

`elea27#1#0#`

- Received directly after issuing a watering-off command
- #0 = channel number

## Moisture history

### Request: 48

`elea48#1#0#`

### Response: 22 - Moisture history for a date

`elea22#83#0@2023@8@28@00,00,00,00,00,00,00,00,00,00,00,74,81,84,85,86,86,85,86,85,85,84,84,83#`

- Recevied as stream of these responses (one per date) in response
- This is moisture for each hour in the 24hr period

### Response: 23 - Watering event

`#elea23#17#0@2023@8@28@11@49`

### Response: 24 - GrowCube Version
`elea24#11#3.6@4063809#`


# GrowCube protocol transcripts

## Channel 0 brief manual watering

```
Hello, Grow Cube!
LOG 2023-08-29T12:02:50: Received elea24#11#3.6@4063809# after waiting 200ms
elea24#11#3.6@4063809#
LOG 2023-08-29T12:02:50: Sending elea47#3#0@1#
LOG 2023-08-29T12:02:51: Received elea26#1#0# after waiting 900ms
elea26#1#0#
LOG 2023-08-29T12:02:52: Sending elea47#3#0@0#
LOG 2023-08-29T12:02:52: Received elea27#1#0# after waiting 600ms
elea27#1#0#
```

## Channel 1 brief manual watering

```
Hello, Grow Cube!
LOG 2023-08-29T12:06:41: Received elea24#11#3.6@4063809# after waiting 200ms
elea24#11#3.6@4063809#
LOG 2023-08-29T12:06:41: Sending elea47#3#1@1#
LOG 2023-08-29T12:06:42: Received elea26#1#1# after waiting 900ms
elea26#1#1#
LOG 2023-08-29T12:06:43: Sending elea47#3#1@0#
LOG 2023-08-29T12:06:43: Received elea27#1#1# after waiting 600ms
elea27#1#1#
```

## Connect and do nothing

```
Hello, Grow Cube!
2023-08-29T12:24:20: elea24#11#3.6@4063809#
2023-08-29T12:24:23: elea30#1#2#elea33#3#0@0#
2023-08-29T12:24:25: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:24:25: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:24:35: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:24:35: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:24:45: elea21#10#0@82@45@27#
2023-08-29T12:24:45: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:24:46:
2023-08-29T12:24:55: elea21#10#0@82@45@27#
2023-08-29T12:24:55: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:24:56:
2023-08-29T12:25:05: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:25:05: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:25:15: elea21#10#0@82@45@27#
2023-08-29T12:25:15: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:25:16:
2023-08-29T12:25:25: elea21#10#0@82@45@27#
2023-08-29T12:25:25: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:25:26:
2023-08-29T12:25:35: elea21#10#0@82@45@27#
2023-08-29T12:25:35: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:25:36:
2023-08-29T12:25:45: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:25:45: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:25:55: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:25:56: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:26:05: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:26:06: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:26:15: elea21#10#0@82@45@27#
2023-08-29T12:26:15: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:26:16:
2023-08-29T12:26:25: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:26:26: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:26:35: elea21#10#0@82@45@27#
2023-08-29T12:26:36: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:26:36:
```

## Send water and then wait 5 seconds plus

```
Hello, Grow Cube!
2023-08-29T12:28:40: elea24#11#3.6@4063809#
LOG 2023-08-29T12:28:40: Sending elea47#3#1@1#
2023-08-29T12:28:41: elea26#1#1#
2023-08-29T12:28:45: elea30#1#2#elea33#3#0@0#
2023-08-29T12:28:46: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:28:47: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:28:56: elea21#10#0@82@45@27#elea21#9#1@0@45@27#
2023-08-29T12:28:57: elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:29:06: elea21#10#0@82@45@27#
2023-08-29T12:29:07: elea21#9#1@0@45@27#elea21#9#2@0@45@27#elea21#9#3@0@45@27#
2023-08-29T12:29:07:
LOG 2023-08-29T12:29:07: Sending elea47#3#1@0#
elea27#1#1#
```

(n.b. watering stopped by itself own after maybe 3 s)

## History output

elea35#3#0@1#
elea23#17#0@2023@1@24@11@39#elea23#17#0@2023@1@31@14@55#
elea23#17#0@2023@1@31@14@57#elea23#15#0@2023@2@7@8@44#elea23#15#0@2023@2@7@8@
46#elea23#16#0@2023@2@14@5@44#elea23#16#0@2023@2@14@5@46#e
lea23#16#0@2023@2@14@5@48#elea23#17#0@2023@2@23@12@16#elea23#17#0@2023@2@23@12@18#
elea23#17#0@2023@2@23@12@20#elea23#16#0@2023@3@4@18@32#elea23#
16#0@2023@3@4@18@34#elea23#17#0@2023@3@11@13@12#elea23#17#0@2023@3@11@13@14#
elea23#17#0@2023@8@28@11@30#elea23#17#0@2023@8@28@11@32#elea23#17#0@2
023@8@28@11@35#elea23#17#0@2023@8@28@11@37#elea23#17#0@2023@8@28@11@39#
elea23#17#0@2023@8@28@11@41#elea23#17#0@2023@8@28@11@43#elea23#17#0@2023@8@
28@11@45#elea23#17#0@2023@8@28@11@47#elea23#17#0@2023@8@28@11@49#

## History output

```
Hello, Grow Cube!

2023-08-29T16:16:32: 24 #11     #3.6@4063809    #
LOG 2023-08-29T16:16:32: Sending elea48#1#0#

22      #82     #0@2023@7@8@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #82     #0@2023@7@9@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@10@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@11@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@12@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@13@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@14@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@15@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@16@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@17@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@18@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@19@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@20@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@21@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@22@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@23@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@24@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@25@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@26@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@27@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@28@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@29@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@30@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@7@31@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #82     #0@2023@8@1@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #82     #0@2023@8@2@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@8@26@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@8@27@00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
22      #83     #0@2023@8@28@00,00,00,00,00,00,00,00,00,00,00,74,81,84,85,86,86,85,86,85,85,84,84,83
22      #83     #0@2023@8@29@82,81,81,81,81,80,80,81,81,81,80,80,83,84,84,84,84,00,00,00,00,00,00,00
35      #3      #0@1
23      #17     #0@2023@1@24@11@39
23      #17     #0@2023@1@31@14@55
23      #17     #0@2023@1@31@14@57
23      #15     #0@2023@2@7@8@44
23      #15     #0@2023@2@7@8@46
23      #16     #0@2023@2@14@5@44
23      #16     #0@2023@2@14@5@46       #

23      #16     #0@2023@2@14@5@48
23      #17     #0@2023@2@23@12@16
23      #17     #0@2023@2@23@12@18
23      #17     #0@2023@2@23@12@20
23      #16     #0@2023@3@4@18@32
23      #16     #0@2023@3@4@18@34
23      #17     #0@2023@3@11@13@12      #
23      #17     #0@2023@3@11@13@14
23      #17     #0@2023@8@28@11@30
23      #17     #0@2023@8@28@11@32
23      #17     #0@2023@8@28@11@35
23      #17     #0@2023@8@28@11@37
23      #17     #0@2023@8@28@11@39      #
23      #17     #0@2023@8@28@11@41
23      #17     #0@2023@8@28@11@43
23      #17     #0@2023@8@28@11@45
23      #17     #0@2023@8@28@11@47
23      #17     #0@2023@8@28@11@49      #
30      #1      #2
33      #3      #0@0    #
21      #10     #0@84@47@27
21      #9      #1@0@47@27
21      #9      #2@0@47@27
21      #9      #3@0@47@27      #
```
